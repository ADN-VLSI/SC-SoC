# Binary to Gray Code Converter - Testbench Documentation

## Overview
This document describes the testbench for the Binary to Gray Code Converter (`bin_2_gray`) module. The testbench systematically verifies the conversion of binary values to their Gray code equivalents.

## Test Specifications

### Module Parameters
- **WIDTH**: Configurable data width (default: 8 bits)
  - Defines the bit width of both binary input and Gray code output

### Interface Signals
The testbench interfaces with the DUT through the following signals:

| Signal         | Type  | Width     | Description                    |
|----------------|-------|-----------|--------------------------------|
| `bin_i`        | Input | WIDTH     | Binary input value             |
| `gray_o`       | Output| WIDTH     | Gray code output value         |

## Test Flow

### Flow Diagram

<center>
<img src="./bin_2_gray_testbench.svg">
</center>




### Detailed Test Procedure

1. **Initialization Phase**
   - Set test counters to 0 (test_count, pass_count, fail_count)
   - Display test header with WIDTH parameter

2. **Stimulus Generation Phase**
   - Generate binary input values from 0 to 2^WIDTH - 1
   - For each value:
     - Apply to DUT input (`bin_i`)
     - Wait for combinational logic to settle (1 time unit)
     - Read DUT output (`gray_o`)

3. **Verification Phase**
   - For each test:
     - Calculate expected Gray code using the conversion formula
     - Compare actual output with expected value
     - Log result (PASS/FAIL)
     - Update pass/fail counters

4. **Reporting Phase**
   - Display test summary
   - Show total tests, passed, and failed counts
   - Display overall test status (PASSED/FAILED)
   - Finish simulation

## Gray Code Conversion Formula

The Gray code conversion follows the standard algorithm:

```
Gray[MSB] = Binary[MSB]
Gray[i]   = Binary[i] XOR Binary[i+1]  for i = WIDTH-2 down to 0
```

### Example (8-bit):
| Binary | Gray   |
|--------|--------|
| 0      | 0      |
| 1      | 1      |
| 2      | 3      |
| 3      | 2      |
| 4      | 6      |
| 5      | 7      |
| 6      | 5      |
| 7      | 4      |

## Testbench Components

### Signals
- **bin_stimulus**: Binary input generated by up counter (driven by testbench)
- **gray_response**: Gray code output captured from DUT
- **test_count**: Total number of test cases executed
- **pass_count**: Number of passed test cases
- **fail_count**: Number of failed test cases

### Functions

#### `binary_to_gray()`
- **Purpose**: Calculate expected Gray code value from binary input
- **Input**: Binary value
- **Output**: Equivalent Gray code value
- **Algorithm**: Implements the Gray code conversion formula

### Tasks

#### `verify_gray_output()`
- **Purpose**: Verify DUT output against expected value
- **Parameters**: Binary input value
- **Functionality**:
  - Calculates expected Gray code
  - Compares with actual DUT output
  - Logs PASS or FAIL with detailed information
  - Updates pass/fail counters
  - Displays binary and Gray values in both decimal and hexadecimal

## Expected Output Format

### Test Log Entry (PASS)
```
[PASS] Binary: 5 (0x5) → Gray: 7 (0x7)
```

### Test Log Entry (FAIL)
```
[FAIL] Binary: 5 (0x5) → Gray: 6 (0x6) | Expected: 7 (0x7)
```

### Test Summary
```
================================================================================
                         Test Summary
================================================================================
Total Test Cases : 256
Passed          : 256
Failed          : 0
================================================================================
✓ All tests PASSED!
```

## Test Coverage

For WIDTH = 8:
- **Total test cases**: 256 (2^8)
- **Input range**: 0 to 255
- **Coverage**: 100% of all possible input values

## Configuration

To test with different WIDTH values, modify the parameter in your simulation:

```systemverilog
// For 4-bit converter
bin_2_gray_tb #(.WIDTH(4)) testbench_inst();

// For 16-bit converter
bin_2_gray_tb #(.WIDTH(16)) testbench_inst();
```

## Usage

### Running the Testbench

**With Vivado/XSim:**
```bash
xvlog source/bin_2_gray.sv testbench/bin_2_gray_new_tb.sv
xelab bin_2_gray_tb
xsim bin_2_gray_tb -gui
```

**With ModelSim:**
```bash
vlog source/bin_2_gray.sv testbench/bin_2_gray_new_tb.sv
vsim bin_2_gray_tb
run -all
```

## Verification Points

✓ All binary values in range [0, 2^WIDTH) are tested  
✓ Gray code output matches expected conversion formula  
✓ Only one bit changes between consecutive Gray code values  
✓ Output is combinational (no timing delays expected)  
✓ Testbench supports parameterizable WIDTH  

## Notes

- The testbench is **parameterized** and works with any WIDTH value
- The DUT is **combinational logic**, so output is immediate
- The testbench uses a simple up-counter approach for stimulus generation
- Expected Gray code is calculated using a function to ensure accuracy
- All test results are logged to the simulator console

## Date
Created: February 26, 2026
